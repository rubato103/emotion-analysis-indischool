# π“‹ μ‹¤ν¨ λ³µκµ¬ μ‹μ¤ν… μ‚¬μ© κ°€μ΄λ“

## π― κ°μ”

μ‹¤ν¨ λ³µκµ¬ μ‹μ¤ν…μ€ λ¶„μ„ νμ΄ν”„λΌμΈ μ¤‘ μ‹¤ν¨κ°€ λ°μƒν–μ„ λ•, μ²μλ¶€ν„° λ‹¤μ‹ μ‹μ‘ν•μ§€ μ•κ³  μ‹¤ν¨ν• μ§€μ μ—μ„ μ¬μ‹μ‘ν•  μ μκ² ν•΄μ£Όλ” μ‹μ¤ν…μ…λ‹λ‹¤.

## π”§ μ£Όμ” κΈ°λ¥

### 1. **μ²΄ν¬ν¬μΈνΈ μ‹μ¤ν…**
- κ° λ‹¨κ³„λ³„λ΅ μ¤‘κ°„ κ²°κ³Όλ¥Ό μλ™ μ €μ¥
- μ‹¤ν¨ μ‹ κ°€μ¥ μµκ·Ό μ²΄ν¬ν¬μΈνΈμ—μ„ μ¬μ‹μ‘
- μ²΄ν¬ν¬μΈνΈ μ ν¨μ„± κ²€μ¦ (μ‹κ°„, λ°μ΄ν„° ν’μ§)

### 2. **λ°°μΉ μ²λ¦¬ λ³µκµ¬**
- λ€μ©λ‰ λ°μ΄ν„°λ¥Ό μ‘μ€ λ°°μΉλ΅ λ‚λ„μ–΄ μ²λ¦¬
- λ°°μΉλ³„ μ§„ν–‰μƒν™© μ¶”μ 
- μ‹¤ν¨ν• λ°°μΉλ§ μ¬μ²λ¦¬

### 3. **μλ™ μ •λ¦¬**
- μ¤λλ μ²΄ν¬ν¬μΈνΈ μλ™ μ‚­μ 
- μ €μ¥ κ³µκ°„ ν¨μ¨μ  κ΄€λ¦¬

---

## π€ μ‚¬μ© λ°©λ²•

### κΈ°λ³Έ λ³µκµ¬ μ μ©

```r
# λ‹¨μΌ ν•¨μμ— λ³µκµ¬ μ‹μ¤ν… μ μ©
result <- with_recovery("step_name", "script_name", function() {
  # μ‹¤μ  μ‘μ—… μν–‰
  expensive_operation()
})
```

### λ°°μΉ μ²λ¦¬ λ³µκµ¬ μ μ©

```r
# λ€λ‰ λ°μ΄ν„° μ²λ¦¬μ— λ°°μΉ λ³µκµ¬ μ μ©
result <- process_with_batch_recovery(
  data = large_dataset,
  process_function = function(batch) {
    # λ°°μΉλ³„ μ²λ¦¬ λ΅μ§
    return(processed_batch)
  },
  batch_size = 100,
  checkpoint_name = "batch_processing",
  script_name = "my_script"
)
```

---

## π“ μ‹¤μ  μ‚¬μ© μ‹λ‚λ¦¬μ¤

### μ‹λ‚λ¦¬μ¤ 1: μ „μ²΄ κ°μ •λ¶„μ„ μ¤‘ λ„¤νΈμ›ν¬ μ¤λ¥
```
μƒν™©: 1000κ±΄ μ¤‘ 700κ±΄ μ²λ¦¬ ν›„ API μ—°κ²° μ‹¤ν¨
ν•΄κ²°: 700κ±΄κΉμ§€μ κ²°κ³Όλ” μ²΄ν¬ν¬μΈνΈμ— μ €μ¥λ¨
     β†’ μ¬μ‹μ‘ μ‹ 701κ±΄λ¶€ν„° μλ™ μ¬κ°
```

### μ‹λ‚λ¦¬μ¤ 2: λ°μ΄ν„° μ „μ²λ¦¬ μ¤‘ λ©”λ¨λ¦¬ λ¶€μ΅±
```
μƒν™©: λ€μ©λ‰ λ°μ΄ν„° μ²λ¦¬ μ¤‘ λ©”λ¨λ¦¬ λ¶€μ΅±μΌλ΅ μ¤‘λ‹¨
ν•΄κ²°: λ°°μΉλ³„λ΅ μ²λ¦¬ν•μ—¬ μ™„λ£λ λ°°μΉλ” μ €μ¥λ¨
     β†’ μ‹¤ν¨ν• λ°°μΉλ¶€ν„° μ¬μ‹μ‘
```

### μ‹λ‚λ¦¬μ¤ 3: κµ¬κΈ€ μ‹νΈ μ—…λ΅λ“ μ¤‘ μΈμ¦ λ§λ£
```
μƒν™©: λ¶„μ„ μ™„λ£ ν›„ κµ¬κΈ€ μ‹νΈ μ—…λ΅λ“ μ¤‘ μΈμ¦ λ¬Έμ 
ν•΄κ²°: λ¶„μ„ κ²°κ³Όλ” μ΄λ―Έ μ²΄ν¬ν¬μΈνΈμ— μ €μ¥λ¨
     β†’ μΈμ¦ μ¬μ„¤μ • ν›„ μ—…λ΅λ“ λ‹¨κ³„λ§ μ¬μ‹¤ν–‰
```

---

## π“‚ νμΌ κµ¬μ΅°

```
checkpoints/
β”β”€β”€ 01_data_loading_load_data_2024-01-15.RDS        # λ°μ΄ν„° λ΅λ“ μ²΄ν¬ν¬μΈνΈ
β”β”€β”€ 01_data_loading_extract_posts_2024-01-15.RDS    # κ²μ‹κΈ€ μ¶”μ¶ μ²΄ν¬ν¬μΈνΈ
β”β”€β”€ 01_data_loading_prompt_generation_progress.RDS   # λ°°μΉ μ§„ν–‰μƒν™©
β””β”€β”€ 03_analysis_api_processing_batch_1.RDS          # API μ²λ¦¬ λ°°μΉλ³„ μ €μ¥
```

---

## β™οΈ μ„¤μ • μµμ… (config.R)

```r
RECOVERY_CONFIG <- list(
  enable_checkpoints = TRUE,              # μ²΄ν¬ν¬μΈνΈ μ‚¬μ© μ—¬λ¶€
  checkpoint_dir = "checkpoints",         # μ²΄ν¬ν¬μΈνΈ μ €μ¥ λ””λ ‰ν† λ¦¬
  max_checkpoint_age_hours = 24,          # μ²΄ν¬ν¬μΈνΈ μµλ€ μ ν¨ μ‹κ°„
  cleanup_days = 7,                       # μλ™ μ •λ¦¬ μ£ΌκΈ° (μΌ)
  batch_size = 100,                       # κΈ°λ³Έ λ°°μΉ ν¬κΈ°
  auto_recover = TRUE                     # μλ™ λ³µκµ¬ μ‹λ„ μ—¬λ¶€
)
```

---

## π” μ²΄ν¬ν¬μΈνΈ κ΄€λ¦¬

### μ²΄ν¬ν¬μΈνΈ ν™•μΈ
```r
# μ²΄ν¬ν¬μΈνΈ κ΄€λ¦¬μ μƒμ„±
cm <- CheckpointManager$new("script_name")

# μ €μ¥λ μ²΄ν¬ν¬μΈνΈ λ©λ΅ ν™•μΈ
checkpoints <- cm$list_checkpoints()
print(checkpoints)
```

### μλ™ μ²΄ν¬ν¬μΈνΈ μ €μ¥
```r
# μ¤‘μ”ν• μ¤‘κ°„ κ²°κ³Όλ¥Ό μλ™μΌλ΅ μ²΄ν¬ν¬μΈνΈ μ €μ¥
cm$save_checkpoint(important_data, "critical_step")
```

### νΉμ • μ²΄ν¬ν¬μΈνΈ λ΅λ“
```r
# νΉμ • λ‹¨κ³„μ μ²΄ν¬ν¬μΈνΈ μλ™ λ΅λ“
data <- cm$load_checkpoint("step_name")
```

### μ¤λλ μ²΄ν¬ν¬μΈνΈ μ •λ¦¬
```r
# 7μΌ μ΄μƒ λ μ²΄ν¬ν¬μΈνΈ μ‚­μ 
cm$cleanup_old_checkpoints(keep_days = 7)
```

---

## π¨ μ£Όμμ‚¬ν•­

### 1. **μ €μ¥ κ³µκ°„**
- μ²΄ν¬ν¬μΈνΈλ” μƒλ‹Ήν• μ €μ¥ κ³µκ°„μ„ μ‚¬μ©ν•  μ μμ
- μ •κΈ°μ μΈ μ •λ¦¬ ν•„μ” (μλ™ μ •λ¦¬ κΈ°λ¥ ν™μ©)

### 2. **λ°μ΄ν„° μΌκ΄€μ„±**
- μ²΄ν¬ν¬μΈνΈ μƒμ„± ν›„ μ›λ³Έ λ°μ΄ν„°κ°€ λ³€κ²½λλ©΄ λ¬΄ν¨ν™”λ¨
- λ°μ΄ν„° λ³€κ²½ μ‹ `force_rerun = TRUE` μµμ… μ‚¬μ©

### 3. **λ²„μ „ νΈν™μ„±**
- R λ²„μ „μ΄λ‚ ν¨ν‚¤μ§€ λ²„μ „μ΄ ν¬κ² λ‹¬λΌμ§€λ©΄ μ²΄ν¬ν¬μΈνΈκ°€ μ‘λ™ν•μ§€ μ•μ„ μ μμ
- μ„Έμ… μ •λ³΄λ„ ν•¨κ» μ €μ¥λλ―€λ΅ νΈν™μ„± ν™•μΈ κ°€λ¥

---

## π› οΈ λ¬Έμ  ν•΄κ²°

### μ²΄ν¬ν¬μΈνΈ λ΅λ“ μ‹¤ν¨
```r
# κ°•μ  μ¬μ‹μ‘
result <- with_recovery("step_name", "script_name", 
                       recovery_function, force_rerun = TRUE)
```

### λ°°μΉ μ²λ¦¬ μ¤‘λ‹¨
```r
# μ§„ν–‰μƒν™© νμΌ ν™•μΈ
progress_file <- "checkpoints/script_batch_processing_progress.RDS"
if (file.exists(progress_file)) {
  progress <- readRDS(progress_file)
  cat("μ™„λ£λ λ°°μΉ:", length(progress$completed_batches))
}
```

### μ²΄ν¬ν¬μΈνΈ λ””λ ‰ν† λ¦¬ μ΄κΈ°ν™”
```r
# λ¨λ“  μ²΄ν¬ν¬μΈνΈ μ‚­μ  ν›„ μ²μλ¶€ν„° μ‹μ‘
unlink("checkpoints", recursive = TRUE)
```

---

## π’΅ λ¨λ²” μ‚¬λ΅€

1. **μ μ ν• μ²΄ν¬ν¬μΈνΈ μ§€μ **
   - μ‹κ°„μ΄ μ¤λ κ±Έλ¦¬λ” μ‘μ—… μ „ν›„
   - λ„¤νΈμ›ν¬ ν†µμ‹ μ΄ ν•„μ”ν• μ‘μ—… μ „ν›„
   - λ°μ΄ν„° λ³€ν™μ μ£Όμ” λ‹¨κ³„

2. **λ°°μΉ ν¬κΈ° μ΅°μ •**
   - API νΈμ¶: 50-100κ° (νΈμ¶ μ ν• κ³ λ ¤)
   - λ°μ΄ν„° μ²λ¦¬: 1000-5000κ° (λ©”λ¨λ¦¬ κ³ λ ¤)
   - νμΌ μ €μ¥: 10000κ° (I/O ν¨μ¨μ„±)

3. **μ •κΈ°μ μΈ μ •λ¦¬**
   - μ£Όμ” λ¶„μ„ μ™„λ£ ν›„ λ¶ν•„μ”ν• μ²΄ν¬ν¬μΈνΈ μ •λ¦¬
   - μ €μ¥ κ³µκ°„ λ¨λ‹ν„°λ§

μ΄ μ‹μ¤ν…μ„ ν†µν•΄ λ€μ©λ‰ λ°μ΄ν„° λ¶„μ„ μ‹μ—λ„ μ•μ •μ μ΄κ³  ν¨μ¨μ μΈ νμ΄ν”„λΌμΈ μ΄μμ΄ κ°€λ¥ν•©λ‹λ‹¤.