# 🧑‍💻 인간 코더 신뢰도 검증 시스템 가이드

## 🎯 **개요**

AI 감정분석 결과의 정확성을 검증하기 위해 **4명의 인간 코더**가 동일한 데이터를 평가하고, **Krippendorff's Alpha**로 코더 간 신뢰도를 측정하는 시스템입니다.

---

## 🔄 **전체 워크플로우**

```
1단계: AI 샘플 분석 실행
    ↓
2단계: 자동으로 4개 구글 시트 생성
    ↓  
3단계: 4명 코더가 각자 시트에서 작업
    ↓
4단계: 신뢰도 분석 실행 (Krippendorff's Alpha)
    ↓
5단계: 결과 해석 및 리포트 생성
```

---

## 📋 **1단계: AI 분석 및 구글 시트 생성**

### **실행 방법**
```r
# 샘플 크기 설정 (config.R에서)
ANALYSIS_CONFIG <- list(
  sample_post_count = 50,  # 50개 샘플 분석
  target_gdrive_folder = "emotion_analysis_results"
)

# 분석 실행
source("03_감정분석_전체실행_v2.R")
```

### **자동 생성되는 것들**
- ✅ AI 분석 결과 (로컬 저장)
- ✅ 4개의 구글 시트 (각 코더용)
- ✅ 시트 정보 파일 (`human_coding_info_*.csv`)

### **구글 시트 구조**
```
A: post_id              # 게시글 ID
B: content              # 원본 텍스트
C: AI_dominant_emotion  # AI가 분석한 주요 감정
D: AI_confidence_score  # AI 신뢰도 점수 (0-1)
E: AI_rationale        # AI 분석 근거
F: human_agree         # 코더 평가: 동의/비동의/애매함
G: human_emotion       # 대안 감정 (비동의시)
H: confidence_level    # 코더 확신도 (1-5)
I: notes              # 추가 메모
```

---

## 👥 **2단계: 인간 코더 작업 가이드**

### **코더 지침**

#### **F열: human_agree (필수)**
- **동의**: AI 분석이 정확하다고 생각하는 경우
- **비동의**: AI 분석이 틀렸다고 생각하는 경우  
- **애매함**: 판단하기 어려운 경우

#### **G열: human_emotion** 
- **"비동의"인 경우만 작성**
- 올바른 감정을 선택: 기쁨, 슬픔, 분노, 혐오, 공포, 놀람, 애정/사랑, 중립, 기타

#### **H열: confidence_level (필수)**
- 1: 매우 확신하지 않음
- 2: 확신하지 않음  
- 3: 보통
- 4: 확신함
- 5: 매우 확신함

#### **I열: notes (선택)**
- 특이사항이나 판단 근거 메모

### **작업 완료 기준**
- ✅ **95% 이상** 항목 완료 (F열 필수 입력)
- ✅ 비동의 케이스는 G열도 입력
- ✅ 모든 행에 H열 확신도 입력

---

## 📊 **3단계: 신뢰도 분석 실행**

### **실행 방법**
```r
# 모든 코더 작업 완료 후
source("05_신뢰도_분석.R")

# 실행하면 자동으로:
# 1. 시트 정보 파일 목록 출력
# 2. 분석할 파일 선택
# 3. 각 코더 데이터 수집
# 4. Krippendorff's Alpha 계산
# 5. 결과 리포트 생성
```

### **분석 항목**
- **AI 동의/비동의 일치도**: 4명의 코더들이 AI 분석 결과에 대해 얼마나 일치하는가

---

## 📈 **4단계: 결과 해석**

### **Krippendorff's Alpha 해석**
| 값 | 해석 | 의미 |
|---|------|------|
| **α ≥ 0.8** | 매우 높은 신뢰도 | AI 결과를 신뢰할 수 있음 |
| **α ≥ 0.67** | 높은 신뢰도 | AI 결과 사용 가능 |
| **α ≥ 0.5** | 중간 신뢰도 | 주의해서 해석 필요 |
| **α < 0.5** | 낮은 신뢰도 | AI 개선 또는 추가 훈련 필요 |

### **생성되는 결과 파일**
```
results/
├── reliability_analysis_SAMPLE_50posts_*.RDS    # 상세 분석 결과
├── reliability_summary_SAMPLE_50posts_*.csv     # 요약 결과  
└── merged_coder_data_SAMPLE_50posts_*.csv       # 원시 데이터
```

---

## ⚙️ **설정 옵션**

### **config.R 설정**
```r
HUMAN_CODING_CONFIG <- list(
  enable_human_coding = TRUE,           # 인간 코딩 활성화
  num_coders = 4,                      # 코더 수
  upload_sample_only = TRUE,           # 샘플링만 업로드
  min_sample_size = 10,                # 최소 샘플 크기
  coder_names = c("coder1", "coder2", "coder3", "coder4"),
  gdrive_folder = "human_coding_sheets"
)
```

### **설정 변경 예시**
```r
# 더 많은 코더 사용
HUMAN_CODING_CONFIG$num_coders <- 6
HUMAN_CODING_CONFIG$coder_names <- c("A", "B", "C", "D", "E", "F")

# 최소 샘플 크기 조정
HUMAN_CODING_CONFIG$min_sample_size <- 30  # 30개 이상만 처리
```

---

## 🔧 **문제 해결**

### **1. 구글 시트 생성 실패**
```
원인: 구글 인증 문제
해결: R 콘솔에서 gs4_auth() 수동 실행
```

### **2. 코더 데이터 읽기 실패**  
```
원인: 구글 시트 권한 문제
해결: 시트를 "링크 있는 사용자는 편집 가능"으로 설정
```

### **3. Krippendorff's Alpha 계산 오류**
```
원인: irr 패키지 미설치
해결: install.packages("irr")
```

### **4. 낮은 신뢰도 (α < 0.5)**
```
해결 방안:
- 코더 교육 강화
- 분석 기준 명확화  
- 애매한 케이스 제거 후 재분석
- AI 모델 또는 프롬프트 개선
```

---

## 📝 **사용 예시**

### **실제 연구 시나리오**
```r
# 1. 100개 샘플로 AI 분석
ANALYSIS_CONFIG$sample_post_count <- 100
source("03_감정분석_전체실행_v2.R")

# → 4개 구글 시트 자동 생성
# → 코더들에게 URL 전달

# 2. 코더 작업 완료 후 (1주일 후)
source("05_신뢰도_분석.R")

# 3. 결과 확인
# AI 동의/비동의 일치도: α = 0.82 (매우 높은 신뢰도)
# → AI 모델 신뢰 가능, 본격 분석 진행
```

---

## 🎯 **베스트 프랙티스**

### **샘플 크기 권장**
- **파일럿**: 30-50개
- **예비 검증**: 100-200개  
- **본격 검증**: 300-500개

### **코더 관리**
- 사전 교육 및 기준 통일
- 중간 점검 및 피드백
- 완료율 실시간 모니터링

### **품질 관리**
- α ≥ 0.67 달성 목표
- 불일치 케이스 별도 분석
- 개선 사항 도출 후 재검증

이 시스템으로 **과학적이고 신뢰할 수 있는 AI 감정분석 검증**이 가능합니다! 🚀