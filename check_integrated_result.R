# 배치 통합 결과 파일 구조 확인\nlibrary(arrow)\nlibrary(dplyr)\n\n# 통합 결과 파일 로드\nintegrated_file <- \"results/batch_integrated_result.parquet\"\nif (file.exists(integrated_file)) {\n  cat(\"통합 결과 파일 로드:\", integrated_file, \"\\n\")\n  \n  # Parquet 파일 로드\n  integrated_df <- arrow::read_parquet(integrated_file)\n  \n  cat(\"통합 결과 구조:\\n\")\n  cat(\"행 수:\", nrow(integrated_df), \"\\n\")\n  cat(\"열 수:\", ncol(integrated_df), \"\\n\")\n  cat(\"열 이름:\\n\")\n  print(names(integrated_df))\n  \n  cat(\"\\n처음 몇 행:\\n\")\n  print(head(integrated_df))\n  \n  # 일반 분석 결과와 비교\n  regular_files <- list.files(\"results\", pattern = \"analysis_results.*\\\\.parquet$\", full.names = TRUE)\n  if (length(regular_files) > 0) {\n    regular_file <- regular_files[1]  # 첫 번째 일반 분석 결과\n    cat(\"\\n일반 분석 결과 파일:\", basename(regular_file), \"\\n\")\n    \n    regular_df <- arrow::read_parquet(regular_file)\n    cat(\"일반 분석 결과 열 수:\", ncol(regular_df), \"\\n\")\n    cat(\"일반 분석 결과 열 이름:\\n\")\n    print(names(regular_df))\n    \n    # 구조 비교\n    cat(\"\\n구조 비교:\\n\")\n    cat(\"통합 결과 열 수:\", ncol(integrated_df), \"\\n\")\n    cat(\"일반 분석 결과 열 수:\", ncol(regular_df), \"\\n\")\n    \n    common_cols <- intersect(names(integrated_df), names(regular_df))\n    cat(\"공통 열 수:\", length(common_cols), \"\\n\")\n    \n    integrated_only <- setdiff(names(integrated_df), names(regular_df))\n    if (length(integrated_only) > 0) {\n      cat(\"통합 결과에만 있는 열:\", paste(integrated_only, collapse = \", \"), \"\\n\")\n    }\n    \n    regular_only <- setdiff(names(regular_df), names(integrated_df))\n    if (length(regular_only) > 0) {\n      cat(\"일반 분석 결과에만 있는 열:\", paste(regular_only, collapse = \", \"), \"\\n\")\n    }\n  }\n} else {\n  cat(\"통합 결과 파일을 찾을 수 없습니다:\", integrated_file, \"\\n\")\n}